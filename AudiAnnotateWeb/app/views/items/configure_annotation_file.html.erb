
<div id='notice-container' class="container">
  <div class="row">
    <div class="col-sm-11" >
      <h2>
        <%= link_to 'My Projects', my_projects_path %> 
        | 
        <%= link_to @item.repo_name, project_path(@item.user_name, @item.repo_name) %>
        |
        <%= link_to @item.label, item_path(@item.user_name, @item.repo_name, @item.slug) %>      
      </h2>
    </div>
    <%= render 'shared/build_status' %>
  </div>
  <div id="notice"><%= notice %></div>

</div>
<div id='process-annotation-form' class="container">
  <div class="row">
    <div class="col-sm-4">
        <h3>Process annotation file</h3>
      <%= form_with(model: @item, url: process_annotation_file_path, local: true) do |form| %>


      <div class="form-group row">
        <%= form.label :layer, "Annotation Layer Label*", class: "col-sm-12 col-form-label" %>
        <div class="col-sm-12">
          <%= form.text_field :layer, class: 'form-control' %>
        </div>
      </div>

      <table class="table table-bordered table-dark">
        <thead>
          <tr>
            <% @annotation_file.sample_snippet.first.each_with_index do |cell, i|%>
            <th>
              <%= (i+65).chr %>
            </th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @annotation_file.sample_snippet.each do |row| %>
          <tr>
            <% row.each do |cell| %>
            <td><%= cell %></td>
            <% end %>
          </tr>
          <% end %>
        </tbody>
      </table>

      <div class="field">
        <%= check_box_tag(:headers, "1", class: "form-check-input") %> <%= label(:headers, "First row is a header") %>
      </div>
      <div class="field">
        <%= label(:start_time, "Which column contains the start time?") %>
          <%= select_tag(:start_time, options_for_select(@annotation_file.sample_snippet.first.map.with_index{ |cell,i| i }.map{|i| [(65+i).chr, i]})) %>
      </div>
      <div class="field">
        <%= label(:end_time, "Which column contains the end time?") %>
        <%= select_tag(:end_time, options_for_select(@annotation_file.sample_snippet.first.map.with_index{ |cell,i| i }.map{|i| [(65+i).chr, i]})) %>
      </div>
        <div class="field">
        <%= label(:annotation, "Which column contains the annotation?") %>
        <%= select_tag(:annotation, options_for_select(@annotation_file.sample_snippet.first.map.with_index{ |cell,i| i }.map{|i| [(65+i).chr, i]})) %>
      </div>
      <div class="field">
        <%= label(:layer, "Which column contains the layer label?") %>
        <%= select_tag(:layer, options_for_select(@annotation_file.sample_snippet.first.map.with_index{ |cell,i| i }.map{|i| [(65+i).chr, i]})) %>
      </div>

      <%= hidden_field_tag(:annotation_file_basename, @file) %>
      <%= hidden_field_tag(:delimiter, @annotation_file.detect_delimiter) %>
      <%= form.hidden_field(:label) %>
      <%= form.hidden_field(:repo_name) %>
      <%= form.hidden_field(:user_name) %>

      <div class="actions">
        <%= form.submit('Process', class: "btn btn-light") %>
      </div>
      <% end %>
    </div>
    <div class="col-sm-8 inline-explanation">
      <p>Explanation goes here.</p>
    </div>
  </div>
</div>
